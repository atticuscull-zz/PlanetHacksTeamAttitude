<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="./mine.jpg">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
        width: 100%
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0 ;
        padding: 0;
      }
    </style>
    <script src=./simulatedPoints/perlinNoise.js></script>
    <script src=./simulatedPoints/RandomPoints.js></script>
    
  </head>
  <body>
    <div id="map"></div>
    <script>
        var map;
        getLocation();
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
            } else {
                console.log("Geolocation is not supported by this browser.");
            }
        }
        function showPosition(position) {
            var latlon = { lat: position.coords.latitude, lng: position.coords.longitude };
            var locations;
            console.log(latlon);
            map.setCenter(latlon);
            $.ajax({
              url: "http://127.0.0.1:8000/rest/location",
              type: "POST",
              contentType: 'application/json', 
              data: JSON.stringify(latlon),
              success: function() {
                console.log("saved location");
                console.log(JSON.stringify(latlon));
              }
            });
            //simulatePoints(300);
            //makeHeatMap();
            $.get('http://127.0.0.1:8000/rest/locations')
              .done(function(_locations) {
                locations = _locations;
                console.log(locations);
              })
            return latlon;
        }
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 37.787, lng: -122.407},
                zoom: 15
            });
        }

    </script>
    
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4tJcLbYZC__NvchePTf_bjpX8lJaZr4M&libraries=visualization&callback=initMap"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src=./heatmapCreation.js></script>
  </body>
</html>